# Google Cloud Text-to-Speech API 集成设计方案

## 1. 推荐API选择

经过对比分析，推荐使用**Google Cloud Text-to-Speech API**，原因如下：
- 发音质量最自然，利用DeepMind的WaveNet技术
- 支持多种语音风格和语速调整
- 提供合理的免费额度（新用户有$300免费额度）
- 适合语言学习应用场景

## 2. 架构设计

### 2.1 总体架构

```
前端应用 <--> 代理服务器 <--> Google Cloud Text-to-Speech API
```

### 2.2 API密钥管理

**安全考虑**：
- **禁止**在前端代码中直接硬编码API密钥
- 推荐使用代理服务器转发API请求

**临时解决方案**（无后端情况下）：
- 创建API密钥配置文件（不提交到版本控制）
- 使用环境变量注入API密钥
- 添加使用警告和安全提示

### 2.3 缓存策略

- 本地缓存：使用localStorage缓存已合成的音频
- 缓存键：单词内容 + 语音参数
- 缓存过期：7天或手动清除

### 2.4 错误处理流程

1. API调用失败时记录错误日志
2. 显示友好的错误提示
3. 自动回退到Web Speech API
4. 支持重试机制

## 3. 实现策略

### 3.1 音频播放优先级

1. 检查本地缓存
2. 调用Google Cloud Text-to-Speech API
3. 失败时回退到Web Speech API

### 3.2 用户选项

- 添加设置项让用户选择默认发音引擎
- 保留切换发音风格的选项

## 4. 性能优化

- 预加载常用单词的发音
- 批量请求优化
- 音频格式优化（使用MP3或OGG格式）

## 5. 免费额度使用

- 实施请求节流
- 优化缓存策略
- 监控API使用量

## 6. 替代方案

如果Google Cloud API不合适，可考虑以下替代：
- **Azure Speech Services**：提供多种语言支持
- **Amazon Polly**：适合长时间文本的语音合成
- **开源TTS引擎**：如Mozilla TTS（需自托管）